<!DOCTYPE html>



 <html class="no-js"> 
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="author" content="Jerod Santo">
    <meta property="og:site_name" content="Jerod Santo">
    
    <meta name="description" content="One Ruby feature that I fell in love with back in the day is the ability to tack conditionals on at the end of a line. For example, this bit of code:
if some_condition?
  object.perform_some_action
end
Can be expressed as a one-liner, like this:
object.perform_some_action if some_condition?
It&rsquo;s a small difference, but the latter form often maps more directly to how the author thinks about the problem. It feels even better when teamed with the unless keyword:">
    <meta property="st:title" content="Trailing Conditionals Considered Harmful Unless Used Sparingly">
    <meta property="og:title" content="Trailing Conditionals Considered Harmful Unless Used Sparingly">
    <meta property="og:description" content="One Ruby feature that I fell in love with back in the day is the ability to tack conditionals on at the end of a line. For example, this bit of code:
if some_condition?
  object.perform_some_action
end
Can be expressed as a one-liner, like this:
object.perform_some_action if some_condition?
It&rsquo;s a small difference, but the latter form often maps more directly to how the author thinks about the problem. It feels even better when teamed with the unless keyword:">
    <meta property="og:type" content="article">
    
    <meta property="og:image" content="/icon.png">
    
    
    <title>
      Trailing Conditionals Considered Harmful Unless Used Sparingly | Jerod Santo
    </title>

    <link rel="icon" href="/icon.png" sizes="256x256" type="image/png">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" media="all" href="/styles.css">
    <script>
       
      window.grunticon=function(e){if(e&&3===e.length){var t=window,n=!(!t.document.createElementNS||!t.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")||window.opera&&-1===navigator.userAgent.indexOf("Chrome")),o=function(o){var r=t.document.createElement("link"),a=t.document.getElementsByTagName("script")[0];r.rel="stylesheet",r.href=e[o&&n?0:o?1:2],a.parentNode.insertBefore(r,a)},r=new t.Image;r.onerror=function(){o(!1)},r.onload=function(){o(1===r.width&&1===r.height)},r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}};
      grunticon(["/icons/icons.data.svg.css", "/icons/icons.data.png.css", "/icons/icons.fallback.css"]);
    </script>

    <link href='//fonts.googleapis.com/css?family=Roboto+Condensed:400italic,400' rel='stylesheet' type='text/css'>
    <script src="//use.typekit.net/ozg5mvx.js"></script>
    <script>try{Typekit.load();}catch(e){}</script>
    <script src="/js/modernizr-custom.js"></script>

    

    <link rel="alternate" type="application/atom+xml" href="/index.xml" />
  </head>
  <body class="">
    
    <div class="main-header">
      <h1>
        <a href="/" title="Home">
          <span class="big-dot">&middot;</span> Jerod Santo <span class="big-dot">&middot;</span>
        </a>
      </h1>
      <a href="javascript:void(0);" title="Moar" class="main-header-more">+</a>
      <a href="/archives/" title="View Blog Archives" class="main-header-archive">Archives</a>
      <a href="mailto:jerod.santo@gmail.com" title="Contact Jerod" class="main-header-contact">Contact</a>
      <a href="/search/" title="Search the site" class="main-header-search">Search</a>
    </div>
    

    
<article class="post">
  <header class="post-header">
    <h1>Trailing Conditionals Considered Harmful Unless Used Sparingly</h1>
    
    <p class="post-date">
      March 8, 2015
    </p>
  </header>

  

  <div class="post-content">
    <p>One Ruby feature that I fell in love with back in the day is the ability to tack conditionals on at the end of a line. For example, this bit of code:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#cf222e">if</span> some_condition?
</span></span><span style="display:flex;"><span>  object<span style="color:#0550ae">.</span>perform_some_action
</span></span><span style="display:flex;"><span><span style="color:#cf222e">end</span>
</span></span></code></pre></div><p>Can be expressed as a one-liner, like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>object<span style="color:#0550ae">.</span>perform_some_action <span style="color:#cf222e">if</span> some_condition?
</span></span></code></pre></div><p>It&rsquo;s a small difference, but the latter form often maps more directly to how the author thinks about the problem. It feels even better when teamed with the <code>unless</code> keyword:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>object<span style="color:#0550ae">.</span>perform_some_action <span style="color:#cf222e">unless</span> some_condition?
</span></span></code></pre></div><p>After years of writing and reading code like this, I&rsquo;ve slowly grown cold on the style.</p>
<h1 id="why">Why</h1>
<p>The reason why I&rsquo;m bearish on trailing conditionals may best be expressed by a road sign I saw on a recent road trip down Interstate 80:</p>
<p><img src="http://jerodsanto.net/drop/i-80-closed.jpg" alt="Not the actual sign I saw, but close enough"></p>
<p>Notice the trailing conditional? A lot can go wrong with signs like these if the driver doesn&rsquo;t make it to the final line of the text. Why might that happen?</p>
<ul>
<li>The sign could be blocked by some obstruction until the last second</li>
<li>The driver could be distracted by kids, the radio, their phone, etc. until it&rsquo;s too late</li>
<li>A sign-related exit could be imminent with the driver in the wrong lane<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></li>
</ul>
<p>In this case, <strong>WHEN FLASHING</strong> is the key indicator on the sign. Why is it the last thing mentioned? In the world of journalism they call this <a href="http://en.wiktionary.org/wiki/bury_the_lead">burying the lead</a>.</p>
<p>If the sign designer place <strong>WHEN FLASHING</strong> first, the driver could often skip the rest of the text altogether<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>. This saves cognitive overhead that the driver can use elsewhere and avoids potential disasters that might occur if the conditional isn&rsquo;t understood in time.</p>
<p>In a slightly-tangential way, trailing conditionals violate the <a href="http://en.wikipedia.org/wiki/Principle_of_least_astonishment">Principle of Least Surprise</a>. This principle — as most important things in life — made its way in to a Mitch Hedberg joke, in which he picks a fight with the phrase &ldquo;Do Not Disturb&rdquo;:</p>
<iframe width="100%" height="166" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/194783967&amp;color=ff5500&amp;auto_play=false&amp;hide_related=false&amp;show_comments=false&amp;show_user=false&amp;show_reposts=false"></iframe>
<p>The problem is exacerbated when driving 80 MPH on the interstate, but it exists in our code as well. The trailing conditional feels great when you&rsquo;re <em>writing</em> the code, but it often makes it harder to <em>read</em>. This is most obvious when the operation that precedes the conditional is verbose. Take this fake code, for instance:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>call_this_really_long_method_that_is_probably_too_long_but_that_will_not_stop_us <span style="color:#cf222e">unless</span> some_condition?
</span></span></code></pre></div><p>What if you didn&rsquo;t scroll over to see the <code>unless</code> at the end? You wouldn&rsquo;t know what&rsquo;s going on at all. Admittedly, method names of this length are rare, but <em>it is</em> common to have trailing conditionals nested inside other control structures that have the same effect<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>.</p>
<p><a href="http://blogs.msdn.com/b/oldnewthing/archive/2007/04/06/2036150.aspx">Code is read much more often than it is written</a>, so we need to optimize for readability over writeability<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>. Trailing conditionals tend to do the opposite.</p>
<h2 id="but">But</h2>
<p>As with most things in software (and writing), there are exceptions. Some uses of trailing conditionals improve readability. The best case for them in my experience is with <a href="http://en.wikipedia.org/wiki/Guard_(computer_science)">guard clauses</a>. Guard clauses have a few characteristics that make them quite readable with trailing conditionals:</p>
<ul>
<li>They occur at the top of a method, so they are rarely nested themselves</li>
<li>They often return or raise an error, which are brief statements</li>
<li>There are often a few guard clauses together, so vertical brevity aides reading</li>
</ul>
<p>Take a look at this method which returns a <code>price_range</code> string for a given object that responds to <code>price_minimum</code> and <code>price_maximum</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#cf222e">def</span> <span style="color:#6639ba">price_range</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">return</span> <span style="color:#953800">@price_range</span> <span style="color:#cf222e">if</span> defined? <span style="color:#953800">@price_range</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">return</span> <span style="color:#0a3069">&#34;&#34;</span> <span style="color:#cf222e">unless</span> price_minimum
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">return</span> <span style="color:#0a3069">&#34;&#34;</span> <span style="color:#cf222e">unless</span> price_maximum
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#57606a"># ... code to determine `minimum` and `maximum` ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#953800">@price_range</span> <span style="color:#0550ae">=</span> <span style="color:#0a3069">&#34;</span><span style="color:#0a3069">#{</span>minimum<span style="color:#0a3069">}</span><span style="color:#0a3069">-</span><span style="color:#0a3069">#{</span>maximum<span style="color:#0a3069">}</span><span style="color:#0a3069">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">end</span>
</span></span></code></pre></div><p>The first line <a href="http://en.wikipedia.org/wiki/Memoization">memoizes</a> the <code>price_range</code>, since this is apparently an expensive computation. Lines 2 and 3 are guard clauses. What would this look like with traditional conditionals?</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#cf222e">def</span> <span style="color:#6639ba">price_range</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">if</span> defined? <span style="color:#953800">@price_range</span>
</span></span><span style="display:flex;"><span>    <span style="color:#cf222e">return</span> <span style="color:#953800">@price_range</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">unless</span> price_minimum
</span></span><span style="display:flex;"><span>    <span style="color:#cf222e">return</span> <span style="color:#0a3069">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">unless</span> price_maximum
</span></span><span style="display:flex;"><span>    <span style="color:#cf222e">return</span> <span style="color:#0a3069">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#57606a"># ... code to determine `minimum` and `maximum` ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#953800">@price_range</span> <span style="color:#0550ae">=</span> <span style="color:#0a3069">&#34;</span><span style="color:#0a3069">#{</span>minimum<span style="color:#0a3069">}</span><span style="color:#0a3069">-</span><span style="color:#0a3069">#{</span>maximum<span style="color:#0a3069">}</span><span style="color:#0a3069">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">end</span>
</span></span></code></pre></div><p>This code requires more vertical work to parse. There&rsquo;s a 3rd form it could take, which is to put the conditionals first and still keep each one a one-liner:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#cf222e">def</span> <span style="color:#6639ba">price_range</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">if</span> defined? <span style="color:#953800">@price_range</span> <span style="color:#cf222e">return</span> <span style="color:#953800">@price_range</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">if</span> <span style="color:#0550ae">!</span>price_minimum <span style="color:#cf222e">return</span> <span style="color:#0a3069">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#cf222e">if</span> <span style="color:#0550ae">!</span>price_maximum <span style="color:#cf222e">return</span> <span style="color:#0a3069">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#57606a"># ... code to determine `minimum` and `maximum` ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#953800">@price_range</span> <span style="color:#0550ae">=</span> <span style="color:#0a3069">&#34;</span><span style="color:#0a3069">#{</span>minimum<span style="color:#0a3069">}</span><span style="color:#0a3069">-</span><span style="color:#0a3069">#{</span>maximum<span style="color:#0a3069">}</span><span style="color:#0a3069">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">end</span>
</span></span></code></pre></div><p>This works for me, but I prefer the return-first form because any time a method returns early we want to know about that <em>ASAP</em>.</p>
<h2 id="so">So</h2>
<p>Think twice before slinging around trailing conditionals. They put the cart before the horse and in extreme cases they cause the reader to miss the horse altogether. This makes them often less readable than the traditional form.</p>
<p>Or maybe Mitch was right and we all just need to read faster!</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>This is actually what happened to me. I barely deciphered the correct meaning in time.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>The road being closed is the exception, not the common case. This means the lights will rarely flash and the sign is most often irrelevant.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>This is <a href="http://stackoverflow.com/a/578318">yet another reason</a> that I advocate for 80-characters or less per line.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>The two are often coupled, but are sometimes at odds.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

  </div>

  <ul class="post-share-buttons">
    <li class="service_twitter post-share-1">
      <a class="icon-twitter" href="https://twitter.com/intent/tweet?url=http%3a%2f%2flocalhost%3a1313%2f2015%2f03%2ftrailing-conditionals-considered-harmful-unless-used-sparingly%2f&via=jerodsanto&text=Trailing%20Conditionals%20Considered%20Harmful%20Unless%20Used%20Sparingly" title="Tweet">
        <span>Tweet</span>
      </a>
    </li>
    <li class="service_rss post-share-2">
      <a class="icon-rss" href="/index.xml" title="Subscribe to the feed!">
        <span>RSS</span>
      </a>
    </li>
    <li class="service_hackernews post-share-3">
      <a class="icon-hackernews" href="http://news.ycombinator.com/submitlink?u=http%3a%2f%2flocalhost%3a1313%2f2015%2f03%2ftrailing-conditionals-considered-harmful-unless-used-sparingly%2f&t=Trailing%20Conditionals%20Considered%20Harmful%20Unless%20Used%20Sparingly" title="Post to Hacker News">
        <span>Hacker News</span>
      </a>
    </li>
    <li class="service_instapaper post-share-4">
      <a class="icon-instapaper" href="http://www.instapaper.com/hello2?url=http%3a%2f%2flocalhost%3a1313%2f2015%2f03%2ftrailing-conditionals-considered-harmful-unless-used-sparingly%2f&title=Trailing%20Conditionals%20Considered%20Harmful%20Unless%20Used%20Sparingly" title="Read later">
        <span>Instapaper</span>
      </a>
    </li>
  </ul>

  
  

  <div id="disqus_thread"></div>
  <script>
    var disqus_url   = "http:\/\/localhost:1313\/2015\/03\/trailing-conditionals-considered-harmful-unless-used-sparingly\/";
    var disqus_title = "Trailing Conditionals Considered Harmful Unless Used Sparingly";
    (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = 'https://blogt0sk1.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>

  <script src="//platform.twitter.com/widgets.js"></script>
</article>


    <footer class="main-footer">
  <p>
    Copyright &copy; 2008&mdash;2025 Jerod Santo
  </p>
</footer>

    
    <script src="/js/compiled.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3287978-16', 'auto');
      ga('send', 'pageview');
    </script>
    
  </body>
</html>